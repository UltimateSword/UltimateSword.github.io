---
title: 线性回归
key: 20220302
tag: math
---

# 1 一元一次方程

形如`y=kx+b(k≠0)`的函数称为一元一次函数

他是为了解决什么问题呢？

举个例子。仓库累计有100个果子，你每天可以从果园里再摘50个，那么仓库中x天后累计多少个果子？

y = kx + b (k=50, b=100)
```python
import numpy as np
import pandas as pd
import plotly.express as px
import torch
import statsmodels.api as sm
from statsmodels.discrete import discrete_model
```

画出10天的图形长这样,可以看到他们全部都在一条线上。
![](https://ultimatesword.github.io/post_image/一元一次方程.png)

# 2 多元线性回归

一元一次方程的假设是每天都可以摘到50个果子。实际上存在问题。

很简单，今天能摘到50个果子，不意味着明天也可以摘到50个果子。

这背后可能有很深刻的哲学思想：这个世界上没有什么是稳定不变的，但是在一定动态范围大部分事情又几乎是守恒的。

比如即使是最精密的机械表，每天旋转的次数都是不一样的，但是又都接近24小时上下。

这样的误差在真实世界里几乎无处不在。

那么明天能摘多少果子？

猜测可能是在一个均值上下波动。假设服从N(50, 20)

画出图像是这样的：
![](https://ultimatesword.github.io/post_image/线性回归.png.png)


这时候发现无法用一条直线把所有点连起来。

这时候如何估计仓库中的果子数量呢？

数学不好的人会随便找两个点连一条线。

但是有一个很直观的想法是如果这条直线离所有点的距离之和最近，那么这条直线是更符合直觉的选择。

这在数学上叫做：OLS(ordinary least squares) 

中文常见的翻译：最小二乘法，直译：普通最小平方法。

最小二乘法可以说信达雅了，但是这样的文不文，古不古的翻译我觉得在数学里非常恶心。因为不知道一眼明白他想表达什么。因此不如直译最小平方法。

接下来画出ols拟合曲线如图，可以看到有几个参数。y=44.6013 * x + 88.975(k=44.6013, b=88.975), R方=0.9513

确定系数的理解看[这里](https://zhuanlan.zhihu.com/p/143132259)

拟合趋势见图：
![](https://ultimatesword.github.io/post_image/线性回归2.png)


这就是线性回归。大概理解就是很多杂七杂八的点回归到了一根直线上

这样又可以愉快计算x天后仓库中的果子y了

回头分析这个过程，我们为了拟合这条直线其实做了两件事。

1. 我们假设每天摘到的果子符合正态分布。也就是在均值上下波动，概率随着波动的增大迅速减小。
2. 我们认为一条直线离所有点的距离之和最小时这条直线的位置最为合理。

第一件事叫做模型，我们规定了每天摘得果子必须服从N(u,a)的正太分布，N也就是我们拟合的曲线的均值。a是方差。

第二件事叫做策略，策略是u和a有很多可能性，我们基于最小平方法和的方法【又名最小二乘法】，确认我们选取的u和a确实是最优解。

最后我们把我们做的这两件事叫做线性回归。


虽然我们知道了线性回归怎么计算了。这是初高中的内容。

但是站在更高的视角，我们做任何事情都希望低耦合，高内聚。
因此希望我们希望我们的预测能力尽可能强，我们的预测方法尽可能解耦，最好是可插拔的形式。

比如我们可以把正态分布拔下来，把泊松分布，负二项分布等插上去。这时候线性回归就变成了刚有的概念，随着我们用的模型不同分为普通线性回归，泊松线性回归，负二项线性回归。统称为广义线性回归。



